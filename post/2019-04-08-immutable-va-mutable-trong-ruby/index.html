<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Immutable vÃ  mutable - The more your try, the more your learn</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Duy Chinh" /><meta name="description" content="Äáº·t váº¥n Ä‘á» Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  tÃ´i khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ Ä‘á»ƒ Ä‘áº·t cáº£, bÃ i viáº¿t náº±m trong má»› kiáº¿n thá»©c rá»‘i bÃ²ng bong cá»§a tÃ´i, vÃ  giá» tÃ´i cáº§n viáº¿t láº¡i nhÆ° má»™t cÃ¡ch Ä‘á»ƒ Ã´n táº­p, hy vá»ng nÃ³ cÃ³ thá»ƒ giÃºp Ä‘Æ°á»£c ai Ä‘Ã³.
Luáº­n bÃ n 1. KhÃ¡i niá»‡m mutable, immutable vÃ  ruby Äi tháº³ng vÃ o váº¥n Ä‘á», chÃºng ta cáº§n Ä‘á» cáº­p Ä‘áº¿n ba váº¥n Ä‘á»: mutable, immutable vÃ  cÃ¡ch ruby xá»­ lÃ½ hai khÃ¡i niá»‡m Ä‘Ã³." /><meta name="keywords" content="ruby, rails, lap trinh, lam web, bao mat, hoc javascript, docker, postgresql, mysql" />






<meta name="generator" content="Hugo 0.55.6 with even 4.0.0" />


<link rel="canonical" href="https://1312047.github.io/post/2019-04-08-immutable-va-mutable-trong-ruby/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Immutable vÃ  mutable" />
<meta property="og:description" content="Äáº·t váº¥n Ä‘á» Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  tÃ´i khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ Ä‘á»ƒ Ä‘áº·t cáº£, bÃ i viáº¿t náº±m trong má»› kiáº¿n thá»©c rá»‘i bÃ²ng bong cá»§a tÃ´i, vÃ  giá» tÃ´i cáº§n viáº¿t láº¡i nhÆ° má»™t cÃ¡ch Ä‘á»ƒ Ã´n táº­p, hy vá»ng nÃ³ cÃ³ thá»ƒ giÃºp Ä‘Æ°á»£c ai Ä‘Ã³.
Luáº­n bÃ n 1. KhÃ¡i niá»‡m mutable, immutable vÃ  ruby Äi tháº³ng vÃ o váº¥n Ä‘á», chÃºng ta cáº§n Ä‘á» cáº­p Ä‘áº¿n ba váº¥n Ä‘á»: mutable, immutable vÃ  cÃ¡ch ruby xá»­ lÃ½ hai khÃ¡i niá»‡m Ä‘Ã³." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://1312047.github.io/post/2019-04-08-immutable-va-mutable-trong-ruby/" />
<meta property="article:published_time" content="2019-04-08T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2019-04-08T00:00:00&#43;00:00"/>

<meta itemprop="name" content="Immutable vÃ  mutable">
<meta itemprop="description" content="Äáº·t váº¥n Ä‘á» Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  tÃ´i khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ Ä‘á»ƒ Ä‘áº·t cáº£, bÃ i viáº¿t náº±m trong má»› kiáº¿n thá»©c rá»‘i bÃ²ng bong cá»§a tÃ´i, vÃ  giá» tÃ´i cáº§n viáº¿t láº¡i nhÆ° má»™t cÃ¡ch Ä‘á»ƒ Ã´n táº­p, hy vá»ng nÃ³ cÃ³ thá»ƒ giÃºp Ä‘Æ°á»£c ai Ä‘Ã³.
Luáº­n bÃ n 1. KhÃ¡i niá»‡m mutable, immutable vÃ  ruby Äi tháº³ng vÃ o váº¥n Ä‘á», chÃºng ta cáº§n Ä‘á» cáº­p Ä‘áº¿n ba váº¥n Ä‘á»: mutable, immutable vÃ  cÃ¡ch ruby xá»­ lÃ½ hai khÃ¡i niá»‡m Ä‘Ã³.">


<meta itemprop="datePublished" content="2019-04-08T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-04-08T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1470">



<meta itemprop="keywords" content="ruby,programming," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Immutable vÃ  mutable"/>
<meta name="twitter:description" content="Äáº·t váº¥n Ä‘á» Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  tÃ´i khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ Ä‘á»ƒ Ä‘áº·t cáº£, bÃ i viáº¿t náº±m trong má»› kiáº¿n thá»©c rá»‘i bÃ²ng bong cá»§a tÃ´i, vÃ  giá» tÃ´i cáº§n viáº¿t láº¡i nhÆ° má»™t cÃ¡ch Ä‘á»ƒ Ã´n táº­p, hy vá»ng nÃ³ cÃ³ thá»ƒ giÃºp Ä‘Æ°á»£c ai Ä‘Ã³.
Luáº­n bÃ n 1. KhÃ¡i niá»‡m mutable, immutable vÃ  ruby Äi tháº³ng vÃ o váº¥n Ä‘á», chÃºng ta cáº§n Ä‘á» cáº­p Ä‘áº¿n ba váº¥n Ä‘á»: mutable, immutable vÃ  cÃ¡ch ruby xá»­ lÃ½ hai khÃ¡i niá»‡m Ä‘Ã³."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Chinh&#39;s notes</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Chinh&#39;s notes</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Immutable vÃ  mutable</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-04-08 </span>
        
          <span class="more-meta"> 1470 words </span>
          <span class="more-meta"> 7 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#Ä‘áº·t-váº¥n-Ä‘á»">Äáº·t váº¥n Ä‘á»</a></li>
<li><a href="#luáº­n-bÃ n">Luáº­n bÃ n</a>
<ul>
<li><a href="#1-khÃ¡i-niá»‡m-mutable-immutable-vÃ -ruby">1. KhÃ¡i niá»‡m mutable, immutable vÃ  ruby</a></li>
<li><a href="#2-liá»‡u-Ä‘Ã¢y-cÃ³-pháº£i-lÃ -má»™t-kiáº¿n-thá»©c-cáº§n-thiáº¿t">2. Liá»‡u Ä‘Ã¢y cÃ³ pháº£i lÃ  má»™t kiáº¿n thá»©c cáº§n thiáº¿t?</a></li>
</ul></li>
<li><a href="#káº¿t-luáº­n">Káº¿t luáº­n</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h2 id="Ä‘áº·t-váº¥n-Ä‘á»">Äáº·t váº¥n Ä‘á»</h2>

<p>Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y lÃ  tÃ´i khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ Ä‘á»ƒ Ä‘áº·t cáº£, bÃ i viáº¿t náº±m trong má»› kiáº¿n thá»©c rá»‘i bÃ²ng bong cá»§a tÃ´i, vÃ  giá» tÃ´i cáº§n viáº¿t láº¡i nhÆ° má»™t cÃ¡ch Ä‘á»ƒ Ã´n táº­p, hy vá»ng nÃ³ cÃ³ thá»ƒ giÃºp Ä‘Æ°á»£c ai Ä‘Ã³.</p>

<h2 id="luáº­n-bÃ n">Luáº­n bÃ n</h2>

<h3 id="1-khÃ¡i-niá»‡m-mutable-immutable-vÃ -ruby">1. KhÃ¡i niá»‡m mutable, immutable vÃ  ruby</h3>

<p>Äi tháº³ng vÃ o váº¥n Ä‘á», chÃºng ta cáº§n Ä‘á» cáº­p Ä‘áº¿n ba váº¥n Ä‘á»: <code>mutable</code>, <code>immutable</code> vÃ  cÃ¡ch ruby xá»­ lÃ½ hai khÃ¡i niá»‡m Ä‘Ã³. TrÆ°á»›c háº¿t náº¿u báº¡n Ä‘Ã£ quÃªn, thÃ¬ tÃ´i xin Ä‘Æ°á»£c nháº¯c láº¡i Ä‘á»‹nh nghÄ©a cá»§a chÃºng.</p>

<p>Xin trÃ­ch dáº«n <a href="https://en.wikipedia.org/wiki/Immutable_object">wiki</a>:</p>

<blockquote>
<p>In object-oriented and functional programming, an immutable object (unchangeable[1] object) is an object whose state cannot be modified after it is created.[2] This is in contrast to a mutable object (changeable object), which can be modified after it is created.</p>
</blockquote>

<p>Translate:</p>

<blockquote>
<p>Trong láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng vÃ  láº­p trÃ¬nh hÃ m, má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c coi immutable, lÃ  má»™t Ä‘á»‘i tÆ°á»£ng <strong>khÃ´ng thá»ƒ thay Ä‘á»•i</strong> tráº¡ng thÃ¡i sau khi nÃ³ Ä‘Æ°á»£c táº¡o láº§n Ä‘áº§u, ngÆ°á»£c láº¡i vá»›i má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c coi lÃ  mutable nÃ³ cÃ³ thá»ƒ <strong>thay Ä‘á»•i</strong> tráº¡ng thÃ¡i sau khi Ä‘Æ°á»£c khá»Ÿi táº¡o láº§n Ä‘áº§u.</p>
</blockquote>

<p>DÃ¹ng tá»« quÃ¡ khÃ³ hiá»ƒu, what the hell is &ldquo;tráº¡ng thÃ¡i&rdquo;? Theo má»™t cÃ¡ch hÃ n lÃ¢m vÃ  Ä‘áº§y Ä‘á»§, tráº¡ng thÃ¡i cá»§a má»™t Ä‘á»‘i tÆ°á»£ng ngoÃ i Ä‘á»i tháº­t Ä‘Æ°á»£c thiáº¿t láº­p bá»Ÿi táº¥t cáº£ nhá»¯ng gÃ¬ táº¡o nÃªn chÃºng.</p>

<p>TÆ°Æ¡ng tá»±, cÃ¡c tráº¡ng thÃ¡i cá»§a má»™t Ä‘á»‘i tÆ°á»£ng trong láº­p trÃ¬nh cÅ©ng Ä‘Æ°á»£c thiáº¿t láº­p báº±ng táº¥t cáº£ nhá»¯ng gÃ¬ táº¡o nÃªn chÃºng. VÃ­ dá»¥:</p>

<p>Vá»›i 1 biáº¿n integer cÆ¡ báº£n <code>x = 10</code> thÃ¬ tráº¡ng thÃ¡i cá»§a nÃ³ Ä‘Æ°á»£c táº¡o ra bá»Ÿi tÃªn biáº¿n vÃ  giÃ¡ trá»‹, á»Ÿ Ä‘Ã¢y tÃªn biáº¿n lÃ  <code>x</code> vÃ  giÃ¡ trá»‹ lÃ  <code>10</code>, Ä‘Ã¢u Ä‘Ã³ trong vÃ¹ng nhá»› (Ram) cá»§a báº¡n sáº½ lÆ°u trá»¯ cÃ¡i chá»¯ <code>x</code> kÃ¨m sá»‘ <code>10</code> nÃ y.</p>

<p>Äá»“ng nghÄ©a vá»›i Ä‘Ã³ náº¿u tÃ´i thay Ä‘á»•i Ä‘Æ°á»£c giÃ¡ trá»‹ 10 cá»§a biáº¿n x thÃ¬ x lÃ  má»™t Ä‘á»‘i tÆ°á»£ng mutable vÃ  ngÆ°á»£c láº¡i nÃ³ lÃ  má»™t Ä‘á»‘i tÆ°á»£ng immutable.</p>

<p>TÃ´i gÃ¡n <code>x = 11</code> vÃ  thÃ nh cÃ´ng</p>

<p>Tá»« Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°a ra káº¿t luáº­n x lÃ  má»™t mutable?</p>

<p>CÃ¢u tráº£ lá»i lÃ  khÃ´ng, má»™t sá»‘ khÃ¡i niá»‡m rá»‘i ráº¯m lÃ m khÃ³ ta lÃºc Ä‘áº§u. NhÆ° Ä‘Ã£ biáº¿t, thá»© mÃ  CPU lÃ m viá»‡c lÃ  Ä‘á»‹a chá»‰ vÃ¹ng nhá»› vÃ  chá»‰ Ä‘á»‹a chá»‰ vÃ¹ng nhá»› mÃ  thÃ´i. Nhá»¯ng thá»© khÃ¡c nÃ³ khÃ´ng quan tÃ¢m.</p>

<p>Vá»›i cÃ¢u lá»‡nh gÃ¡n <code>x = 10</code>. NÃ³ Ä‘Æ°á»£c há»‡ Ä‘iá»u hÃ nh phiÃªn dá»‹ch thÃ nh &ldquo;cÃ³ má»™t biáº¿n tÃªn <code>x</code> Ä‘Æ°á»£c gÃ¡n giÃ¡ trá»‹ báº±ng <code>10</code>, Ram, mÃ y hÃ£y bá»‘ trÃ­ thÃªm hai slot Ä‘á»ƒ lÆ°u trá»¯ <code>x</code> vÃ  <code>10</code>&rdquo;. Váº­y lÃºc Ä‘Ã³:</p>

<p><code>x</code>(tÃªn biáº¿n) Ä‘Æ°á»£c lÆ°u á»Ÿ vá»‹ trÃ­ AAA
<code>10</code>(giÃ¡ trá»‹) Ä‘Æ°á»£c lÆ°u á»Ÿ vá»‹ trÃ­ BBB</p>

<p>Vá»›i lá»‡nh gÃ¡n tiáº¿p theo <code>x = 11</code>:</p>

<p><code>x</code> váº«n yÃªn vá»‹ náº±m á»Ÿ vá»‹ trÃ­ AAA
<code>10</code> cÅ©ng váº«n yÃªn trÃ­ náº±m á»Ÿ vá»‹ trÃ­ BBB
<code>11</code> giÃ¡ trá»‹ má»›i gÃ¡n cho biáº¿n x thÃ¬ lÃºc nÃ y náº±m á»Ÿ vá»‹ trÃ­ CCC</p>

<p>Váº­y khi cháº¡y má»™t lá»‡nh gÃ¡n má»›i thÃ¬ biáº¿n x Ä‘Ã£ Ä‘Æ°á»£c gÃ¡n báº±ng giÃ¡ trá»‹ trÃªn má»™t vÃ¹ng nhá»› khÃ¡c, cÃ²n vÃ¹ng nhá»› ban Ä‘áº§u <strong>khÃ´ng thay Ä‘á»•i giÃ¡ trá»‹</strong> nÃªn ta cÃ³ thá»ƒ káº¿t luáº­n x lÃ  má»™t immutable.</p>

<p>Chá»©ng minh báº±ng vÃ­ dá»¥ sau trong ruby, chÃº Ã½ lÃ  ruby lÃ  má»™t ngÃ´n ngá»¯ script, vá»›i trÃ¬nh thÃ´ng dá»‹ch VM bÃªn dÆ°á»›i Ä‘á»ƒ xá»­ lÃ½ cá»§a nÃ³ Ä‘Æ°á»£c viáº¿t báº±ng C, nÃªn á»Ÿ lá»›p cÆ¡ sá»Ÿ cá»§a ruby ta khÃ´ng thá»ƒ truy xuáº¥t vá»‹ trÃ­ vÃ¹ng nhá»› Ä‘áº¿n tá»«ng thanh ghi nhÆ° trong C Ä‘Æ°á»£c (viá»‡c Ä‘Ã³ Ä‘Æ°á»£c lÃ m á»Ÿ lá»›p core YARV). Tuy nhiÃªn, ta cÃ³ thá»ƒ kiáº¿m tra Ä‘Æ°á»£c vá»‹ trÃ­ tÆ°á»£ng trÆ°ng trÃªn bá»™ nhá»› cá»§a nÃ³ thÃ´ng qua <code>object_id</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span><span class="o">.</span><span class="n">object_id</span> 
<span class="c1">#=&gt; 21</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">x</span><span class="o">.</span><span class="n">object_id</span>
<span class="c1">#=&gt; 23</span></code></pre></td></tr></table>
</div>
</div>
<p>Note: Náº¿u báº¡n gÃ¡n tiáº¿p x = 12 vÃ  kiá»ƒm tra láº¡i object_id, lÃºc nÃ y báº¡n sáº½ tháº¥y nÃ³ báº±ng 25. GiÃ¡ trá»‹ 10, 11, 12 tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i object_id lÃ  21, 23, 25. Liá»‡u cÃ³ má»™t quy luáº­t nÃ o á»Ÿ Ä‘Ã¢y? CÃ¢u tráº£ lá»i lÃ  cÃ³, nhÆ°ng váº¥n Ä‘á» nÃ y sáº½ Ä‘Æ°á»£c Ä‘á» cáº­p Ä‘áº¿n trong má»™t bÃ i viáº¿t tiáº¿p theo.</p>

<p>Tá»« vÃ­ dá»¥ trÃªn báº¡n Ä‘Ã£ hiá»ƒu vá» immutable, váº­y cÃ²n mutable? ÄÆ¡n giáº£n nháº¥t lÃ  hÃ£y hiá»ƒu ngÆ°á»£c láº¡i vá»›i immutable, nÃªu gÃ¡n x = 11 vÃ  x cÃ³ object_id khÃ´ng Ä‘á»•i thÃ¬ x chÃ­nh lÃ  mutable.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">Táº¥t cáº£ cÃ¡c loáº¡i dá»¯ liá»‡u nguyÃªn thuá»· trong ruby Ä‘á»u lÃ  immutable.</pre></td></tr></table>
</div>
</div>
<p>Integer, float, string, boolean chÃºng Ä‘á»u lÃ  immutable.</p>

<h3 id="2-liá»‡u-Ä‘Ã¢y-cÃ³-pháº£i-lÃ -má»™t-kiáº¿n-thá»©c-cáº§n-thiáº¿t">2. Liá»‡u Ä‘Ã¢y cÃ³ pháº£i lÃ  má»™t kiáº¿n thá»©c cáº§n thiáº¿t?</h3>

<p>Cháº¯c cháº¯n lÃ  cÃ³.</p>

<p>Thá»© nháº¥t: Náº¿u trong cÃ´ng viá»‡c báº¡n khÃ´ng bao giá» pháº£i dÃ¹ng Ä‘áº¿n nÃ³, báº¡n cÃ³ thá»ƒ nÃ³i vá» nÃ³ nhÆ° má»™t kiáº¿n thá»©c hÃ n lÃ¢m Ä‘á»ƒ thá»ƒ hiá»‡n kháº£ nÄƒng vá»›i sáº¿p vÃ  yÃªu cáº§u tÄƒng lÆ°Æ¡ng ğŸ˜Ÿ</p>

<p>Thá»© hai: XÃ©t vÃ­ dá»¥ sau</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="o">[</span><span class="s2">&#34;Hoang&#34;</span><span class="p">,</span> <span class="s2">&#34;Duy&#34;</span><span class="p">,</span> <span class="s2">&#34;Chinh&#34;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
  <span class="n">str</span> <span class="o">+=</span> <span class="n">i</span>
<span class="k">end</span></code></pre></td></tr></table>
</div>
</div>
<p>TÆ° tÆ°á»Ÿng cá»§a Ä‘oáº¡n mÃ£ nÃ y lÃ  cá»™ng táº¥t cáº£ cÃ¡c pháº§n tá»­ trong má»™t máº£ng string vÃ  cho ra káº¿t quáº£ cuá»‘i cÃ¹ng lÃ  má»™t chuá»—i tá»•ng há»£p táº¥t cáº£ cÃ¡c pháº§n tá»­.
CÃ³ Ä‘iá»u gÃ¬ báº¥t thÆ°á»ng trong Ä‘oáº¡n mÃ£ nÃ y khÃ´ng nhá»‰? CÃ¢u tráº£ lá»i lÃ  cÃ³. NhÆ° nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ nÃ³i á»Ÿ trÃªn cÃ³ hai Ä‘iá»u cáº§n lÆ°u Ã½:</p>

<blockquote>
<ol>
<li><p>CÃ¡c kiá»ƒu dá»¯ liá»‡u nguyÃªn thuá»· trong ruby Ä‘á»u lÃ  immutable vÃ  hiá»ƒn nhiÃªn string khÃ´ng ngoáº¡i lá»‡.</p></li>

<li><p>Khi má»™t object lÃ  immutable, thÃ¬ viá»‡c báº¡n gÃ¡n nÃ³ báº±ng má»™t giÃ¡ trá»‹ khÃ¡c Ä‘á»“ng nghÄ©a vá»›i viá»‡c vÃ¹ng nhá»› cÅ© sáº½ khÃ´ng Ä‘Æ°á»£c dÃ¹ng Ä‘áº¿n, mÃ  nÃ³ sáº½ ra má»™t vÃ¹ng nhá»› má»›i rá»“i ghi káº¿t quáº£ má»›i lÃªn Ä‘Ã³, cá»© láº·p láº¡i nhÆ° váº­y mÃ£i mÃ£i.</p></li>
</ol>
</blockquote>

<p>Tá»« hai Ä‘iá»u trÃªn ta rÃºt ra Ä‘Æ°á»£c káº¿t luáº­n:</p>

<ol>
<li>Trong láº§n gÃ¡n Ä‘áº§u tiÃªn str cÃ³ giÃ¡ trá»‹ lÃ  chuá»—i rá»—ng vÃ  Ä‘Æ°á»£c khá»Ÿi táº¡o táº¡i vÃ­ trÃ­ A1</li>
<li>Trong láº§n láº·p <code>each</code> Ä‘áº§u tiÃªn, str cÃ³ giÃ¡ trá»‹ lÃ  &ldquo;Hoang&rdquo; vÃ  nÃ³ lÆ°u á»Ÿ vá»‹ trÃ­ A2</li>
<li>Trong láº§n láº·p <code>each</code> thá»© hai, str cÃ³ giÃ¡ trá»‹ má»›i lÃ  &ldquo;HoangDuy&rdquo; vÃ  nÃ³ lÆ°u á»Ÿ vá»‹ trÃ­ má»›i lÃ  A3</li>
<li>Trong láº§n láº·p cuá»‘i cÃ¹ng thÃ¬ str cÃ³ giÃ¡ trá»‹ chÃºng ta mong Ä‘á»£i lÃ  &ldquo;HoangDuyChinh&rdquo; vÃ  nÃ³ lÆ°u á»Ÿ vá»‹ trÃ­ A4</li>
</ol>

<p>Chá»©ng minh:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="nb">puts</span> <span class="s2">&#34;First location: </span><span class="si">#{</span><span class="n">str</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="o">[</span><span class="s2">&#34;Hoang&#34;</span><span class="p">,</span> <span class="s2">&#34;Duy&#34;</span><span class="p">,</span> <span class="s2">&#34;Chinh&#34;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
  <span class="n">str</span> <span class="o">+=</span> <span class="n">i</span>  
  <span class="nb">puts</span> <span class="s2">&#34;value: </span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="s2"> | location: </span><span class="si">#{</span><span class="n">str</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="k">end</span>     

<span class="nb">puts</span> <span class="s2">&#34;Final value: </span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="s2"> | location: </span><span class="si">#{</span><span class="n">str</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>Káº¿t quáº£:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">First location: 47434608564740
value: Hoang | location: 47434608564520
value: HoangDuy | location: 47434608564440
value: HoangDuyChinh | location: 47434608564360
Final value: HoangDuyChinh | location: 47434608564360</pre></td></tr></table>
</div>
</div>
<p>VÃ  thá»© chÃºng ta quan tÃ¢m tá»« Ä‘Ã³ vá» sau lÃ  vá»‹ trÃ­ A4 nÃ y. Váº­y cÃ²n A1, A2, A3 cÅ©ng Ä‘ang mang giÃ¡ trá»‹? ChÃºng Ä‘i Ä‘Ã¢u vá» Ä‘Ã¢u? ChÃ­nh xÃ¡c, nÃ³ trá»Ÿ thÃ nh má»™t vÃ¹ng nhá»› rÃ¡c vÃ  sáº½ Ä‘Æ°á»£c GC dá»n dáº¹p nhÆ°ng khÃ´ng pháº£i ngay láº­p tá»©c, váº­y trong khoáº£ng thá»i gian Ä‘Ã³ nÃ³ váº«n náº¯m giá»¯ cÃ¡c vÃ¹ng nhá»› cá»§a chÃºng ta. ÄÃ³ cÅ©ng lÃ  má»™t trong cÃ¡c lÃ½ do viá»‡c báº¡n muá»‘n cháº¡y ruby on rails trÃªn má»™t chiáº¿c mÃ¡y tÃ­nh sinh viÃªn 2GB lÃ  vÃ´ cÃ¹ng khÃ³ khÄƒn. Ruby Äƒn Ram nhÆ° uá»‘ng nÆ°á»›c lÃ£ váº­y.</p>

<p>VÃ­ dá»¥ trÃªn máº£ng ta cÃ³ ba pháº§n tá»­ vÃ  ta cÃ³ 3 giÃ¡ trá»‹ rÃ¡c trÃªn bá»™ nhá»›, hÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n cÃ³ má»™t máº£ng má»™t triá»‡u pháº§n tá»­ ğŸ˜Ÿ</p>

<p>Giáº£i phÃ¡p trong trÆ°á»ng há»£p nÃ y lÃ  gÃ¬? ÄÃ³ lÃ  duyá»‡t máº£ng nhÆ° má»™t <code>object reference</code> chá»© khÃ´ng pháº£i má»™t biáº¿n giÃ¡ trá»‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="o">[</span><span class="s2">&#34;Hoang&#34;</span><span class="p">,</span> <span class="s2">&#34;Duy&#34;</span><span class="p">,</span> <span class="s2">&#34;Chinh&#34;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
  <span class="n">str</span> <span class="o">&lt;&lt;</span> <span class="n">i</span>
<span class="k">end</span></code></pre></td></tr></table>
</div>
</div>
<p>NhÆ° váº­y str sáº½ á»Ÿ Ä‘Ãºng má»™t vÃ¹ng nhá»› vÃ  ta khÃ´ng cÃ³ má»™t Ä‘á»‘ng biáº¿n rÃ¡c khÃ´ng mong Ä‘á»£i.</p>

<p>Chá»©ng minh:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="nb">puts</span> <span class="s2">&#34;First location: </span><span class="si">#{</span><span class="n">str</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="o">[</span><span class="s2">&#34;Hoang&#34;</span><span class="p">,</span> <span class="s2">&#34;Duy&#34;</span><span class="p">,</span> <span class="s2">&#34;Chinh&#34;</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> 
  <span class="n">str</span> <span class="o">&lt;&lt;</span> <span class="n">i</span>
  <span class="nb">puts</span> <span class="s2">&#34;value: </span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="s2"> | location: </span><span class="si">#{</span><span class="n">str</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="k">end</span>

<span class="nb">puts</span> <span class="s2">&#34;Final value: </span><span class="si">#{</span><span class="n">str</span><span class="si">}</span><span class="s2"> | location: </span><span class="si">#{</span><span class="n">str</span><span class="o">.</span><span class="n">object_id</span><span class="si">}</span><span class="s2">&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>Káº¿t quáº£:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">First location: 47196120971580
value: Hoang | location: 47196120971580
value: HoangDuy | location: 47196120971580
value: HoangDuyChinh | location: 47196120971580
Final value: HoangDuyChinh | location: 47196120971580</pre></td></tr></table>
</div>
</div>
<h2 id="káº¿t-luáº­n">Káº¿t luáº­n</h2>

<p>Trong bÃ i viáº¿t cÃ³ Ä‘á» cáº­p Ä‘áº¿n <code>object_id</code> vÃ  <code>GC</code>, Ä‘Ã¢y lÃ  hai váº¥n Ä‘á» ná»n táº£ng trong ruby, hy vá»ng sáº½ cÃ³ kháº£ nÄƒng viáº¿t cÃ¡c bÃ i khÃ¡c vá» hai chá»§ Ä‘á» nÃ y, náº¿u cÃ³ tháº¯c máº¯c hay Ä‘Ã³ng gÃ³p cho thiáº¿u xÃ³t cá»§a tÃ¡c giáº£, hÃ£y Ä‘á»ƒ láº¡i bÃ¬nh luáº­n bÃªn dÆ°á»›i ğŸ˜„.</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Duy Chinh</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2019-04-08
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/ruby/">ruby</a>
          <a href="/tags/programming/">programming</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2019-04-10-upload-file-len-aws-s3-va-nhung-van-de-can-luu-y/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Upload vá»›i S3 trong rails</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2019-02-25-van-de-n&#43;1-trong-rails/">
            <span class="next-text nav-default">Cá»¥c ná»£ N &#43; 1 vÃ  cÃ¡ch xá»­ lÃ½</span>
            <span class="next-text nav-mobile">BÃ i sau</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:hduychinh@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://facebook.com/hoangduychinh1995" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://www.linkedin.com/in/chinhhd308/" class="iconfont icon-linkedin" title="linkedin"></a>
  <a href="https://1312047.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  

  <span class="copyright-year">
    &copy; 
    2018 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Duy Chinh</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>








</body>
</html>
